GIT_VERSION := $(shell git describe --abbrev=6 --dirty --always --tags)
CC=gcc
CFLAGS=-Wall --std=c99 -Werror -DVERSION=\"$(GIT_VERSION)\" -g

all: readSpeedTest writeSpeedTest writePairTest checkDisks

readSpeedTest: readSpeedTest.c utils.o logSpeed.o 
	gcc -Wall --std=c99 $^ -o $@ -lpthread -lm

writeSpeedTest: writeSpeedTest.c utils.o logSpeed.o
	gcc -Wall --std=c99 $^ -o $@ -lpthread -lm

writePairTest: writePairTest.o utils.o logSpeed.o
	gcc -Wall --std=c99 $^ -o $@ -lpthread -lm

mtWriteSpeedTest: mtWriteSpeedTest.o utils.o logSpeed.o
	gcc -Wall --std=c99 $^ -o $@ -lpthread -lm

mtReadSpeedTest: mtReadSpeedTest.o utils.o logSpeed.o 
	gcc -Wall --std=c99 $^ -o $@ -lpthread -lm

checkDisks: checkDisks.o utils.o logSpeed.o aioOperations.o
	gcc -Wall --std=c99 $^ -o $@ -lpthread -lm -laio

utils.o: utils.c utils.h

logSpeed.o: logSpeed.c logSpeed.h

shmem.o: shmem.c shmem.h

aioOperations.o: aioOperations.c aioOperations.h

logSpeedTest: logSpeedTest.o utils.o logSpeed.o

clean:
	- rm -f readSpeedTest writeSpeedTest writePairTest logSpeedTest *.o \
	mtReadSpeedTest mtWriteSpeedTest checkDisks


